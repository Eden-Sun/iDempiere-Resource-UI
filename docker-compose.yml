services:
  dev-server:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "8888:8888"
    volumes:
      - ./ui:/app
    working_dir: /app
    environment:
      - NODE_ENV=development
      - VITE_API_IP=192.168.1.47
      - VITE_DEFAULT_USER=i7eadmin
      - VITE_DEFAULT_PASS=i7eadmin
    command: bun run dev -- --host 0.0.0.0 --port 8888

  opencode-web:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "5555:5555"
    volumes:
      - .:/app
      - opencode-data:/root/.local/share/opencode/
      - ${HOME}/.ssh:/root/.ssh:ro
      - ${HOME}/.gitconfig:/root/.gitconfig:ro
    working_dir: /app
    environment:
      - NODE_ENV=development
      - GIT_SSH_COMMAND=ssh -i /root/.ssh/id_rsa -o StrictHostKeyChecking=accept-new
    command: opencode web --hostname 0.0.0.0 --port 5555

volumes:
  opencode-data: